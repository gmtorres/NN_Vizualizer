(this["webpackJsonpnn-visual"]=this["webpackJsonpnn-visual"]||[]).push([[0],{10:function(e,t,a){e.exports={grid_wrapper:"DataGrid_grid_wrapper__244vq",grid_container:"DataGrid_grid_container__jXyzr",entry:"DataGrid_entry__2K7di",active:"DataGrid_active__1xSOz",entry_value:"DataGrid_entry_value__oKi1E",entry_label:"DataGrid_entry_label__1_qD-",entry_separator:"DataGrid_entry_separator__2Cz9e",entry_button:"DataGrid_entry_button__3kMeX",grid_container_buttons:"DataGrid_grid_container_buttons__IWFi9"}},100:function(e,t,a){},13:function(e,t,a){e.exports={splitScreen:"Layout_splitScreen__1IutT",leftPane:"Layout_leftPane__kbmS8",leftPane_content_wrapper:"Layout_leftPane_content_wrapper__37c12",content_wrapper:"Layout_content_wrapper__2_XKn",InfoPanel_wrapper:"Layout_InfoPanel_wrapper__1g6lB",InfoPanel_content:"Layout_InfoPanel_content__GHD45",leftPane_content:"Layout_leftPane_content__28MIS",rightPane:"Layout_rightPane__3z6oq",rightPane_section:"Layout_rightPane_section__1QR0L",buttons_container:"Layout_buttons_container__WKhKc",div_buttons_container:"Layout_div_buttons_container__14b2V",lower_buttons_container:"Layout_lower_buttons_container__2c14K"}},15:function(e,t,a){e.exports={VisualNN:"VisualNN_VisualNN__2VnbU",svgWrapper:"VisualNN_svgWrapper__1wKYA",addLayerButton:"VisualNN_addLayerButton__3mRF3",activation_opt:"VisualNN_activation_opt__1AxW-",opt_active:"VisualNN_opt_active__iPL_g"}},246:function(e,t,a){},247:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a(2),s=a.n(n),r=a(87),o=a.n(r),l=(a(99),a(100),a(46)),h=a.n(l),c=function(){return Object(i.jsx)("div",{className:h.a._navbar,children:Object(i.jsx)("div",{className:h.a._navbar_left,children:"Neural Network Visualizer"})})},u=a(12),d=a(6),p=a(7),b=a(9),j=a(8),f=a(93),v=a(3),_={linear:{func:function(e){return e},deriv:function(e){return 1}},sigm:{func:function(e){return 1/(1+Math.exp(-e))},deriv:function(e){return e*(1-e)}},relu:{func:function(e){return e>0?e:0},deriv:function(e){return e>0?1:0}},relu2:{func:function(e){return e>0?e:.1*e},deriv:function(e){return e>0?1:.1}}};function g(){var e=Object(v.a)(["Delta "],["\\Delta "]);return g=function(){return e},e}function y(){var e=Object(v.a)(["",""]);return y=function(){return e},e}function x(){var e=Object(v.a)(["",""]);return x=function(){return e},e}var m=function(){function e(t,a){Object(d.a)(this,e),this.n_layers=3,this.bias=!0,this.learning_rate=.02,this.training_times=200,this.layers=[],this.layer_activation=[],this.max_height=0,this.createRandomNN(t,a),this.expression=[],this.action=""}return Object(p.a)(e,[{key:"getTrainingTimes",value:function(){return this.training_times}},{key:"setTrainingTimes",value:function(e){this.training_times=e}},{key:"getLearningRate",value:function(){return this.learning_rate}},{key:"setLearningRate",value:function(e){this.learning_rate=e}},{key:"getInputLayerSize",value:function(){return this.bias?this.layers[0].length-1:this.layers[0].length}},{key:"getOutputLayerSize",value:function(){return this.layers[this.layers.length-1].length}},{key:"getLayerSize",value:function(e){return e===this.layers.length-1?this.layers[e].length:this.bias?this.layers[e].length-1:this.layers[e].length}},{key:"addInputNode",value:function(){for(var e=[],t=0;t<this.getLayerSize(1);t++)e.push(Math.random());this.layers[0].splice(this.getLayerSize(0),0,{value:NaN,edges:e,edges_old:[].concat(e)}),this.layers[0].length>this.max_height&&(this.max_height=this.layers[0].length)}},{key:"addOutputNode",value:function(){for(var e=0;e<this.layers[this.layers.length-2].length;e++)this.layers[this.layers.length-2][e].edges.push(Math.random());this.layers[this.layers.length-1].push({value:NaN,edges:[1]}),this.layers[this.layers.length-1].length>this.max_height&&(this.max_height=this.layers[this.layers.length-1].length)}},{key:"addNode",value:function(e){for(var t=0;t<this.layers[e-1].length;t++)this.layers[e-1][t].edges.push(Math.random());for(var a=[],i=0;i<this.getLayerSize(e+1);i++)a.push(Math.random());this.layers[e].splice(this.getLayerSize(e),0,{value:NaN,edges:a,edges_old:[].concat(a)}),this.layers[e].length>this.max_height&&(this.max_height=this.layers[e].length)}},{key:"addLayer",value:function(e){for(var t=0;t<this.layers[e].length;t++)this.layers[e][t].edges=[];if(this.layers.splice(e+1,0,[]),this.bias){for(var a=[],i=0;i<this.getLayerSize(e+2);i++)a.push(Math.random());this.layers[e+1].push({value:1,edges:a,edges_old:[].concat(a)})}this.layer_activation.splice(e+1,0,null),this.setLayerActivation(e+1,"sigm"),this.addNode(e+1)}},{key:"deleteInputNode",value:function(e){this.layers[0].splice(e,1),this.max_height=0;for(var t=0;t<this.layers.length;t++)this.layers[t].length>this.max_height&&(this.max_height=this.layers[t].length)}},{key:"deleteOutputNode",value:function(e){for(var t=0;t<this.layers[this.layers.length-2].length;t++)this.layers[this.layers.length-2][t].edges.splice(e,1);this.layers[this.layers.length-1].splice(e,1),this.max_height=0;for(var a=0;a<this.layers.length;a++)this.layers[a].length>this.max_height&&(this.max_height=this.layers[a].length)}},{key:"setLayerActivation",value:function(e,t){_.hasOwnProperty(t)&&(this.layer_activation[e]={name:t,activation:_[t]})}},{key:"resetVars",value:function(){this.step_layer=null,this.step_node=null}},{key:"createRandomNN",value:function(e,t){this.resetVars(),this.layers=[],this.max_height=0;for(var a=0;a<this.n_layers;a++){var i=[],n=Math.floor(3*Math.random())+2;0===a&&null!==e&&void 0!==e&&(n=e),a===this.n_layers-1&&null!==t&&void 0!==t&&(n=t);for(var s=0;s<n;s++)i.push({value:Math.round(1e3*Math.random())/1e3,edges:[]});this.bias&&a!==this.n_layers-1&&i.push({value:1,edges:[]}),i.length>this.max_height&&(this.max_height=i.length),this.layers.push(i),this.setLayerActivation(a,"sigm")}this.randomize()}},{key:"randomize",value:function(){this.resetVars();for(var e=0;e<this.layers.length;e++)for(var t=0;t<this.layers[e].length;t++)if(this.layers[e][t].edges=[],e===this.layers.length-1)this.layers[e][t].edges.push(1);else{var a=this.layers[e+1].length;e+1<this.layers.length-1&&this.bias&&(a-=1);for(var i=0;i<a;i++)this.layers[e][t].edges.push(Math.random());this.layers[e][t].edges_old=this.layers[e][t].edges}this.clearNodes()}},{key:"clearNodes",value:function(){for(var e=0;e<this.layers.length;e++){var t=this.layers[e].length;e<this.layers.length-1&&this.bias&&(t-=1);for(var a=0;a<t;a++)this.layers[e][a].value=NaN,this.layers[e][a].error=NaN}}},{key:"setInputLayer",value:function(e){if(null!=e)for(var t=0;t<e.length;t++)this.layers[0][t].value=parseFloat(e[t])}},{key:"feedforward",value:function(e,t){this.setInputLayer(e);for(var a=1;a<this.layers.length;a++)for(var i=this.layers[a-1],n=this.layer_activation[a].activation.func,s=0;s<this.getLayerSize(a);s++){for(var r=0,o=0;o<i.length;o++)r+=i[o].value*i[o].edges[s];this.layers[a][s].value=n(r)}if(null!=t)for(var l=this.layers.length-1,h=0;h<this.layers[l].length;h++)this.layers[l][h].error=this.layers[l][h].value-t[h]}},{key:"feedforwardStepNode",value:function(e,t){if(this.expression=[],null==this.step_node||"feedforward"!==this.action)return this.action="feedforward",this.step_node=0,this.clearNodes(),this.setInputLayer(e),null==this.step_layer&&(this.step_layer=1),!1;var a=this.layers[this.step_layer-1],i=0,n="";n+="in_".concat(this.step_node,"^").concat(this.step_layer,"=");for(var s=0;s<a.length;s++)n+=a[s].value.toFixed(4)+"*"+a[s].edges[this.step_node].toFixed(4),s!==a.length-1&&(n+="+"),i+=a[s].value*a[s].edges[this.step_node];n+=" = "+i.toFixed(4),this.expression.push(String.raw(x(),n));var r="";return this.layers[this.step_layer][this.step_node].value=this.layer_activation[this.step_layer].activation.func(i),r+="out_".concat(this.step_node,"^").concat(this.step_layer,"=activation(in_").concat(this.step_node,"^").concat(this.step_layer,")=")+this.layer_activation[this.step_layer].name+"("+i.toFixed(4)+")="+this.layers[this.step_layer][this.step_node].value.toFixed(4),this.expression.push(String.raw(y(),r)),this.step_node++,this.step_node>=this.getLayerSize(this.step_layer)&&(this.step_node=0,this.step_layer++),this.step_layer>=this.layers.length&&(this.step_layer=null,this.step_node=null,this.action="",!0)}},{key:"feedforwardStepLayer",value:function(e,t){if(this.expression=[],null==this.step_layer||"feedforward"!==this.action)return this.action="feedforward",this.step_layer=1,this.clearNodes(),this.setInputLayer(e),!1;for(var a=this.layers[this.step_layer-1],i=null==this.step_node?0:this.step_node,n=this.layer_activation[this.step_layer].activation.func;i<this.getLayerSize(this.step_layer);i++){for(var s=0,r=0;r<a.length;r++)s+=a[r].value*a[r].edges[i];this.layers[this.step_layer][i].value=n(s)}return this.step_layer++,this.step_layer>=this.layers.length&&(this.step_layer=null,this.step_node=null,this.action="",!0)}},{key:"train",value:function(e,t){this.expression=[];for(var a=0;a<this.training_times;a++)for(var i=0;i<e.length;i++)this.backpropagation(e[i],t[i])}},{key:"backpropagation",value:function(e,t){this.feedforward(e,t);for(var a=this.layers.length-1,i=0;i<this.layers[a].length;i++){var n=this.layers[a][i];n.derivative=this.layer_activation[0].activation.deriv(n.value)*n.error}for(var s=a-1;s>=0;s--)for(var r=this.layers[s].length,o=this.layer_activation[s].activation.deriv,l=0;l<r;l++){for(var h=this.layers[s][l],c=0,u=0;u<h.edges.length;u++)c+=this.layers[s][l].edges[u]*this.layers[s+1][u].derivative;h.derivative=c*o(h.value)}for(var d=a-1;d>=0;d--)for(var p=this.layers[d].length,b=0;b<p;b++)for(var j=this.layers[d][b],f=0;f<j.edges.length;f++)isFinite(j.edges[f])&&(j.edges[f]-=j.value*this.layers[d+1][f].derivative*this.learning_rate,console.log(j.edges[f]))}},{key:"backpropagationLayer",value:function(e,t){if(this.expression=[],null==this.step_layer||"backpropagation"!==this.action)return this.action="backpropagation",this.feedforward(e,t),this.step_layer=this.layers.length-1,!1;var a=this.step_layer-1;if(this.step_layer===this.layers.length-1)for(var i=0;i<this.layers[this.step_layer].length;i++){var n=this.layers[this.step_layer][i];n.derivative=this.layer_activation[0].activation.deriv(n.value)*n.error}else for(var s=this.layers[this.step_layer].length,r=this.layer_activation[this.step_layer].activation.deriv,o=0;o<s;o++){for(var l=this.layers[this.step_layer][o],h=0,c=0;c<l.edges.length;c++)h+=this.layers[this.step_layer][o].edges_old[c]*this.layers[this.step_layer+1][c].derivative;l.derivative=h*r(l.value)}for(var u=this.layers[a].length,d=0;d<u;d++)for(var p=this.layers[a][d],b=0;b<p.edges.length;b++)isFinite(p.edges[b])&&(p.edges_old[b]=p.edges[b],p.edges[b]-=p.value*this.layers[this.step_layer][b].derivative*this.learning_rate,console.log(p.edges[b]));return this.step_layer--,this.step_layer<=0&&(this.step_layer=null,this.step_node=null,this.action="",!0)}},{key:"backpropagationNode",value:function(e,t){if(this.expression=[],null==this.step_node||"backpropagation"!==this.action)return this.action="backpropagation",this.feedforward(e,t),this.step_node=0,null==this.step_layer&&(this.step_layer=this.layers.length-1),!1;var a=String.raw(g());a+="node^".concat(this.step_layer,"_").concat(this.step_node," = ");var i=this.step_layer-1;if(this.step_layer===this.layers.length-1){var n=this.layers[this.step_layer][this.step_node];n.derivative=this.layer_activation[0].activation.deriv(n.value)*n.error,a+=this.layer_activation[0].activation.deriv(n.value).toFixed(4)+"*"+n.error.toFixed(4),a+="="+n.derivative.toFixed(4)}else{var s=this.layer_activation[this.step_layer].activation.deriv,r=this.layers[this.step_layer][this.step_node],o=0;a+="(";for(var l=0;l<r.edges.length;l++)o+=this.layers[this.step_layer][this.step_node].edges_old[l]*this.layers[this.step_layer+1][l].derivative,a+=this.layers[this.step_layer+1][l].derivative.toFixed(4)+"*"+this.layers[this.step_layer][this.step_node].edges_old[l].toFixed(4),l!==r.edges.length-1&&(a+="+");a+=")",r.derivative=o*s(r.value),a+="*"+s(r.value).toFixed(4),a+="="+r.derivative.toFixed(4)}this.expression.push(a);for(var h=this.layers[i].length,c=0;c<h;c++){var u="",d=this.layers[i][c];isFinite(d.edges[this.step_node])&&(d.edges_old[this.step_node]=d.edges[this.step_node],d.edges[this.step_node]-=d.value*this.layers[this.step_layer][this.step_node].derivative*this.learning_rate,console.log(d.edges[this.step_node]),u+="weight_{".concat(c,",").concat(this.step_node,"}^").concat(i,"=")+d.edges_old[this.step_node].toFixed(4)+"-"+this.learning_rate.toFixed(4)+"*"+this.layers[this.step_layer][this.step_node].derivative.toFixed(4)+"*"+d.value.toFixed(4),u+="="+d.edges[this.step_node].toFixed(4),this.expression.push(u))}return this.step_node++,this.step_node>=this.getLayerSize(this.step_layer)&&(this.step_node=0,this.step_layer--),this.step_layer<=0&&(this.step_layer=null,this.step_node=null,this.action="",!0)}},{key:"getRepresentation",value:function(){return{representation:this.layers,height:this.max_height,activation:Object.keys(_),layer_act:this.layer_activation,current_node:this.step_node,current_layer:this.step_layer}}},{key:"export",value:function(){var e={learning_rate:this.learning_rate,bias:this.bias},t=[];return this.layers.forEach((function(e){var a=[];e.forEach((function(e){return a.push(e.edges)})),t.push(a)})),e.weights=t,e}},{key:"import",value:function(e){var t=this;this.layers=[],this.max_height=0,this.bias=e.bias,this.learning_rate=e.learning_rate,e.weights.forEach((function(a){var i=[];a.forEach((function(n){var s={edges:n,edges_old:Object(f.a)(n)};t.bias&&i.length===a.length-1&&t.layers.length!==e.weights.length-1&&(s.value=1),i.push(s)})),t.layers.push(i),a.length>t.max_height&&(t.max_height=a.length)})),this.n_layers=this.layers.length}}]),e}(),w={sample1:{learning_rate:.5,bias:!0,weights:[[[.15,.25],[.2,.3],[.35,.35]],[[.4,.5],[.45,.55],[.6,.6]],[[1],[1]]]}},O=a(35),k=a.n(O),N=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var i;return Object(d.a)(this,a),(i=t.call(this,e)).x=e.x?e.x:50,i.y=e.y?e.y:50,i.r=e.r?e.r:25,i}return Object(p.a)(a,[{key:"render",value:function(){var e="";(this.props.value&&!isNaN(this.props.value)||0===this.props.value)&&(e=Object(i.jsxs)("text",{x:this.x,y:this.y,textAnchor:"middle",fontSize:"smaller",children:["v:",this.props.value]}));var t="";this.props.error&&!isNaN(this.props.error)&&(t=Object(i.jsxs)("text",{x:this.x,y:this.y+this.r/2,textAnchor:"middle",fontSize:"smaller",children:["e:",this.props.error]}));var a=k.a.circle+" "+(this.props.active?k.a.isActive:"");return Object(i.jsxs)("g",{className:k.a.node,children:[Object(i.jsx)("circle",{className:a,cx:this.x,cy:this.y,r:this.r,stroke:"black",strokeWidth:"2",fill:"white"}),e,t]})}}]),a}(s.a.Component),S=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var i;return Object(d.a)(this,a),(i=t.call(this)).x1=e.x1?e.x1:50,i.y1=e.y1?e.y1:50,i.x2=e.x2?e.x2:100,i.y2=e.y2?e.y2:100,i.weight=e.weight?e.weight:void 0,i}return Object(p.a)(a,[{key:"render",value:function(){var e,t,a,n=Math.hypot(this.y1-this.y2,this.x1-this.x2),s=Math.atan2(this.y2-this.y1,this.x2-this.x1),r=(e=-Math.PI/2,t=Math.PI/2,a=0);r=(this.props.dest+1)/(this.props.total+2)*n*1.3;var o={x:this.x1+r*Math.cos(s),y:this.y1+r*Math.sin(s)};s=180*s/Math.PI;var l="rotate(".concat(s,", ").concat(o.x,", ").concat(o.y,")");return Object(i.jsxs)("g",{children:[Object(i.jsx)("line",{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,stroke:"black"}),Object(i.jsx)("text",{x:o.x,y:o.y-10,textAnchor:"middle",fontSize:"smaller",transform:l,children:this.weight})]})}}]),a}(s.a.Component),L=a(15),E=a.n(L),I=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),s=a[0],r=a[1],o=e.opts,l=50,h=o.map((function(t,a){var n=E.a.activation_opt+" ";return n+=t===e.current.name?E.a.opt_active:"",Object(i.jsxs)("g",{children:[Object(i.jsx)("rect",{className:n,x:e.x-25,y:e.y+e.r/2+15*a,width:l,height:"15",style:{stroke:"rgb(0, 0, 0)"}}),Object(i.jsx)("text",{x:e.x+2-25,y:e.y+e.r/2+15*(a+1)-2,fontSize:"smaller",children:t}),Object(i.jsx)("rect",{x:e.x-25,y:e.y+e.r/2+15*a,width:l,height:"15",style:{fill:"transparent"},onClick:function(){e.func(t),r(!1)}})]},"drop_opt_"+a)})),c=s?"block":"none";return Object(i.jsxs)("g",{children:[Object(i.jsx)("rect",{x:e.x-25,y:e.y+e.r/2-15,width:l,height:"15",style:{fill:"rgb(255,255,255)",stroke:"rgb(0, 0, 0)"}}),Object(i.jsx)("text",{x:e.x+2-25,y:e.y+e.r/2-2,fontSize:"smaller",children:e.current.name}),Object(i.jsx)("text",{x:e.x+l-13-25,y:e.y+e.r/2-3,fontSize:"x-small",children:"\u25bc"}),Object(i.jsx)("rect",{x:e.x-25,y:e.y+e.r/2-15,width:l,height:"15",style:{fill:"transparent"},onClick:function(){return r(!s)}}),Object(i.jsx)("g",{display:c,children:h})]})},T=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var i;return Object(d.a)(this,a),(i=t.call(this,e)).ref=s.a.createRef(),i.buildModel(),i.key=0,i}return Object(p.a)(a,[{key:"buildModel",value:function(){var e=this;this.rep=this.props.neuralNetwork_rep,this.layers=this.rep.representation,this.max_height=this.rep.height,this.n_layers=this.rep.representation.length,this.representation=[],this.buttons=[];var t=30,a=50,n=this.props.height-20-60;if(n<0&&(n=this.props.height),0!==n){var s=Math.min(30,n/(this.max_height+2));s=25;for(var r=(this.props.width-50-100)/(this.n_layers-1),o=n/this.max_height,l=this.max_height*o,h=function(t){e.buttons.push(Object(i.jsx)("text",{className:E.a.addLayerButton,x:75+r*t+r/2-5,y:15,onClick:function(){return e.props.func.addLayer(t)},children:"+"},"buttonup_"+t))},c=0;c<this.n_layers-1;c++)h(c);for(var u=function(t){e.buttons.push(Object(i.jsx)("text",{className:E.a.addLayerButton,x:75+r*t-5,y:e.props.height-15,onClick:function(){return e.props.func.addNode(t)},children:"+"},"buttondown_"+t))},d=1;d<this.n_layers-1;d++)u(d);for(var p=1;p<this.n_layers;p++)this.buttons.push(Object(i.jsx)(I,{x:a+r*p+s,y:15,r:s,func:this.props.func.changeActivation.bind(this,p),opts:this.props.neuralNetwork_rep.activation,current:this.props.neuralNetwork_rep.layer_act[p]},"layer_dropDown_"+p));for(var b=[],j=0;j<this.n_layers;j++){for(var f=[],v=(l-o*this.layers[j].length)/2,_=0;_<this.layers[j].length;_++){var g=this.layers[j][_];j===this.n_layers-1?f.push({x:75+r*j,y:35+v+o*_+t,r:s,edges:g.edges,value:g.value,error:g.error}):f.push({x:75+r*j,y:35+v+o*_+t,r:s,edges:g.edges,value:g.value})}b.push(f)}this.representation=b}}},{key:"componentDidMount",value:function(){this.updateRepresentation(),window.addEventListener("resize",this.updateRepresentation.bind(this))}},{key:"updateRepresentation",value:function(){}},{key:"render",value:function(){this.buildModel();var e=this.representation;this.nn=[];for(var t=0;t<e.length;t++){if(t<e.length-1)for(var a=0;a<e[t].length;a++)for(var n=e[t][a],s=0;s<n.edges.length;s++){var r=e[t+1][s];this.nn.push(Object(i.jsx)(S,{x1:n.x,y1:n.y,x2:r.x,y2:r.y,dest:s,total:n.edges.length,weight:Math.round(1e3*n.edges[s])/1e3},"Edge"+t.toString()+a.toString()+s.toString()))}for(var o=0;o<e[t].length;o++){var l=e[t][o];this.nn.push(Object(i.jsx)(N,{x:l.x,y:l.y,r:l.r,value:Math.round(1e3*l.value)/1e3,error:Math.round(1e3*l.error)/1e3,active:this.rep.current_layer===t&&(null==this.rep.current_node||this.rep.current_node===o)},"Node"+t.toString()+","+o.toString()))}}return Object(i.jsx)("div",{className:E.a.svgWrapper,children:Object(i.jsxs)("svg",{width:"100%",height:"100%",ref:this.ref,children:[this.nn,this.buttons]},"svg"+this.key++)})}}]),a}(s.a.Component),D=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var i;return Object(d.a)(this,a),(i=t.call(this,e)).state={height:0,width:0},i}return Object(p.a)(a,[{key:"setHeight",value:function(){if(this.divElement){var e=this.divElement.clientHeight;this.setState({height:e})}}},{key:"setWidth",value:function(){if(this.divElement){var e=this.divElement.clientWidth;this.setState({width:e})}}},{key:"componentDidMount",value:function(){this.setHeight(),this.setWidth(),window.addEventListener("resize",this.setHeight.bind(this)),window.addEventListener("resize",this.setWidth.bind(this))}},{key:"render",value:function(){var e=this;return Object(i.jsx)("div",{className:E.a.VisualNN,ref:function(t){e.divElement=t},children:Object(i.jsx)(T,{neuralNetwork_rep:this.props.neuralNetwork.getRepresentation(),num:this.props.num,height:this.state.height,width:this.state.width,func:this.props.func})})}}]),a}(s.a.Component),F=a(13),z=a.n(F),C=function(){return Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Neural Networks "}),Object(i.jsxs)("p",{children:[" ",Object(i.jsx)("b",{children:"Neural Networks"})," (NN) are inspired by our brains and how they work. Just like our brains NN are composed by series of layers of interconnected (artificial) neurons that send their signals to the next neurons and so on. The artificial neurons process the signals it receives and then forwards the processed value to the neurons in the next layer. The first layer in known as the ",Object(i.jsx)("b",{children:"input layer"})," where we supply the initial values, whereas the last layer is known as the ",Object(i.jsx)("b",{children:"output layer"})," where we get the final values. The intermediate layers are known as",Object(i.jsx)("b",{children:" hidden layers"}),".",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"A Neural Networks can be consisted of several layer of different number of neurons. Neurons or nodes are connected by ",Object(i.jsx)("b",{children:"edges"})," and each edge has a ",Object(i.jsx)("b",{children:"weight"})," associated, which represent how much the value of the origin neuron influences the value in the end neuron. This weight is adjusted during the training phase and by adjusting the weights we can make our inputs match the correspondent outputs, or at least make a ",Object(i.jsx)("b",{children:"prediction"}),".",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"Neural Networks are mainly used in ",Object(i.jsx)("b",{children:"supervised learning"})," tasks, where we give the input and the correspondent output and our model tries to fit the training data, so our model will be a function that maps the input values to output values. Our goal is that our model can generalize even to unseen data and correctly predict the output. It is called supervised learning because we feed the input and we supervise the output, adjusting until we can achieve an acceptable performance.",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"In the Neural Network model we try to achieved nodes or a set of nodes that can recognize certain patterns in our data and activate uppon that. This behaviour arise throught the complex ",Object(i.jsx)("b",{children:"interactions"})," between the previous nodes by the edges connecting them.",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"The process of transforming and processing the inputs into outputs is called ",Object(i.jsx)("b",{children:"feedforward"}),", where we feed our neural network with the input values. Each value is passed to the nodes in the next layer through the edges, stronger edges have greater influence in the next nodes. However a neuron might not be activated by small enough values of the predecessors, which means that neuron will not contribute to the next layer, to accomplish this when need to process the values recevied, this is known as activation function.",Object(i.jsx)("br",{}),"More on feedforward on the next section.",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"To make our inputs match the outputs we have to adjust the weights in each edge, by strengthening or weakening the edge, thus changing the contribution of each node in order to achieve the desired result. We do this with a method called ",Object(i.jsx)("b",{children:"backpropagation"}),", where we try to minimize the error between the predicted value and the output one, in the last layer, and make small, incremental changes in the weights so that the error is a little smaller than previously. We then propagate backwards this calculation.",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"Here we are going to focus on the basis of neural networks and on the most commum and basic layouts. More details in a next sections.",Object(i.jsx)("br",{}),Object(i.jsx)("br",{})]})]})},M=a(88),A=(a(246),function(e){var t=Array.isArray(e.expressions)?e.expressions:[e.expressions];if(void 0===t)return null;var a=t.map((function(e,t){return Object(i.jsx)(M.a,{tex:e},t)})),n=e.height?"":"expression_wrapper";return Object(i.jsx)("div",{className:n,children:a})});function W(){var e=Object(v.a)(["relu(x)= cases { x  & if  x >= 0 cr 0 &  if x < 0  }"],["relu(x)= \\cases { x  & if  x >= 0 \\cr 0 &  if x < 0  }"]);return W=function(){return e},e}function P(){var e=Object(v.a)(["tanh(x)= \frac{e^x - e^{-x}}{e^x + e^{-x}}"],["tanh(x)= \\frac{e^x - e^{-x}}{e^x + e^{-x}}"]);return P=function(){return e},e}function B(){var e=Object(v.a)(["sig(x)= \frac{1}{1 + e^{-x}}"],["sig(x)= \\frac{1}{1 + e^{-x}}"]);return B=function(){return e},e}function R(){var e=Object(v.a)(["out_i^l = activation(in_i^l)"]);return R=function(){return e},e}function V(){var e=Object(v.a)(["in_i^l = sum_{k=1} out_k^{l-1} \times w_{k,i}"],["in_i^l = \\sum_{k=1} out_k^{l-1} \\times w_{k,i}"]);return V=function(){return e},e}var G=function(){var e=String.raw(V()),t=String.raw(R()),a=String.raw(B()),n=String.raw(P()),s=String.raw(W());return Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"FeedForward "}),Object(i.jsxs)("p",{children:["First we need to understand how we transform inputs into output, how the processing of data is made throughout our model. This process is know as ",Object(i.jsx)("b",{children:"feedforward"}),", so let's see how it works!",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"First, in the ",Object(i.jsx)("b",{children:"input layer"})," we place our ",Object(i.jsx)("b",{children:"initial values"}),", we are feeding the input values to the network.",Object(i.jsx)("br",{}),"Now we must ",Object(i.jsx)("b",{children:"foward"})," the input value through the model. For this, each node from the next layer will compute its value from the previous layer. So each node from the previous layer will ",Object(i.jsx)("b",{children:"contribute"})," partly to each neuron on the next layer, this contribution is defined by the ",Object(i.jsx)("b",{children:"weight"}),". So the calculation for each node is as follows:",Object(i.jsx)(A,{expressions:e,height:!0}),"This expression allows us to get a representation, a value, which contains the ",Object(i.jsx)("b",{children:"agregated values"})," of the previous layer, taking into account the ",Object(i.jsx)("b",{children:"weight"})," of each edge between the nodes. We take node ",Object(i.jsx)("i",{children:"n"})," and for each node ",Object(i.jsx)("i",{children:"k"})," from the previous layer, we the sum the multiplication of each value node ",Object(i.jsx)("i",{children:"k"})," by the weight of the edge connecting ",Object(i.jsx)("i",{children:"k"})," to ",Object(i.jsx)("i",{children:"n"}),". The multiplication of the node value of ",Object(i.jsx)("i",{children:"k"})," by the weight of ",Object(i.jsx)("i",{children:"k"})," to ",Object(i.jsx)("i",{children:"n"})," gives us of the ",Object(i.jsx)("b",{children:"node contribution"}),", where that node ",Object(i.jsx)("i",{children:"k"}),", has a higher contribution to nodes where the edge is greater, and smaller where the node is smaller. This operation of sum, then gives us the ",Object(i.jsx)("b",{children:"total contribution"})," of the previous layer to this node.",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"However we need to model how the node will react to this value we have calculated. This operation will transform our ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in value "})}),"into an ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})}),", which will be what the node is going to fire to the next layer. In some sense, comparing to our brains, it decides whether the neuron should ",Object(i.jsx)("b",{children:"activate/fire"})," or not. This operation is helpful in ",Object(i.jsx)("b",{children:"detecting useful patterns"})," in our data, allowing a node or a set of nodes, to understand the data behaviour. This process is makes us of ",Object(i.jsx)("b",{children:"activation functions"}),".",Object(i.jsx)("br",{})," In most cases we use non-linear functions, in order to model more complex and non-linear problems and patterns.",Object(i.jsx)("br",{}),"The ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})}),", or the output value of node ",Object(i.jsx)("i",{children:"n"})," takes the following expression:",Object(i.jsx)(A,{expressions:t,height:!0}),Object(i.jsx)("br",{}),"As we can see, we apply a transformation to our ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in value"})})," we calculated previously, and we get the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})}),". The activation function can take may forms but the most usual are:",Object(i.jsxs)("ul",{children:[Object(i.jsxs)("li",{children:["Sigmoid",Object(i.jsx)(A,{expressions:a,height:!0})]}),Object(i.jsxs)("li",{children:["Tanh",Object(i.jsx)(A,{expressions:n,height:!0})]}),Object(i.jsxs)("li",{children:["RELU",Object(i.jsx)(A,{expressions:s,height:!0})]})]}),Object(i.jsx)("br",{}),"We do the feedfoward through the entire network, from the ",Object(i.jsx)("b",{children:"input layer to the output layer"}),", layer by layer, and the final result will be in the output layer. This final results are known as ",Object(i.jsx)("b",{children:"predictions"})," of our network given the correspondent input values.",Object(i.jsx)("br",{}),"This process of computing the out values, from the in values, from the out values of the previous layer can be seen as complex multidimensional composite function, because we are applying a function to the result of applying another function and so on. So we can see our neural network as a ",Object(i.jsx)("b",{children:"composite function"}),".",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),"To get better results we can implement something known as ",Object(i.jsx)("b",{children:"bias"}),", in which we add to the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in values"})})," of each layer or even node, a constant, fixed amount, which will act as shift in the activation function, allowing us to get a more complex behaviour. This shift will be constant to every input values and won't change the slop or format of the activation function, only moving it to the right or left. In the case of a ",Object(i.jsx)("i",{children:"tanh"}),", when we have an ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in value"})})," of 0, if we apply a bias of -5, instead of 0, we get a ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})})," very close to 1, shifting the activation function to the left.",Object(i.jsx)("br",{}),"This can be achieved by introducing a node in the previous layer with a ",Object(i.jsx)("b",{children:"constant value of 1"}),", and the bias is represented in the",Object(i.jsx)("b",{children:" weights of the the connections"})," between this newly added node and the destination nodes, which means the contribution, bias, equals to the weight of the connection.",Object(i.jsx)("br",{}),Object(i.jsx)("br",{})]})]})};function H(){var e=Object(v.a)([" w_{n,k}^{t+1} = w_{n,k}^{t} \times alpha space Delta w_{n,k}"],[" w_{n,k}^{t+1} = w_{n,k}^{t} \\times \\alpha \\space \\Delta w_{n,k}"]);return H=function(){return e},e}function K(){var e=Object(v.a)([" Delta w_{n,k} = Delta node_n^{l} \times out_n^{l-1}"],[" \\Delta w_{n,k} = \\Delta node_n^{l} \\times out_n^{l-1}"]);return K=function(){return e},e}function X(){var e=Object(v.a)([" Delta node_n^{l} = sum_{k=1} { left( Delta node_k^{l+1} \times w_{n,k} \right) } \times activation'(node_n^l)"],[" \\Delta node_n^{l} = \\sum_{k=1} { \\left( \\Delta node_k^{l+1} \\times w_{n,k} \\right) } \\times activation'(node_n^l)"]);return X=function(){return e},e}function q(){var e=Object(v.a)([" Delta node_n^{last} = (actual_n-out_n^{last}) \times activation'(node_n^{last})"],[" \\Delta node_n^{last} = (actual_n-out_n^{last}) \\times activation'(node_n^{last})"]);return q=function(){return e},e}function J(){var e=Object(v.a)(["\frac{partial E}{partial out_n^l} = sum_{k=1} { left( Delta node_k^{l+1} \times w_{n,k} \right) }"],["\\frac{\\partial E}{\\partial out_n^l} = \\sum_{k=1} { \\left( \\Delta node_k^{l+1} \\times w_{n,k} \\right) }"]);return J=function(){return e},e}function U(){var e=Object(v.a)(["\frac{partial in_k^{l+1}}{partial out_n^l} = w_{n,k}"],["\\frac{\\partial in_k^{l+1}}{\\partial out_n^l} = w_{n,k}"]);return U=function(){return e},e}function Y(){var e=Object(v.a)(["\frac{partial E}{partial out_n^l} = sum_{k=1} { left( \frac{partial E}{partial in_k^{l+1}} \frac{partial in_k^{l+1}}{partial out_n^l} \right) } "],["\\frac{\\partial E}{\\partial out_n^l} = \\sum_{k=1} { \\left( \\frac{\\partial E}{\\partial in_k^{l+1}} \\frac{\\partial in_k^{l+1}}{\\partial out_n^l} \\right) } "]);return Y=function(){return e},e}function Q(){var e=Object(v.a)(["\frac{partial E}{partial w_{k,n}} = \frac{partial E}{partial out_n^l} \times \frac{partial out_n^l}{partial in_n^l} \times \frac{partial in_n^l}{partial w_{k,n}}"],["\\frac{\\partial E}{\\partial w_{k,n}} = \\frac{\\partial E}{\\partial out_n^l} \\times \\frac{\\partial out_n^l}{\\partial in_n^l} \\times \\frac{\\partial in_n^l}{\\partial w_{k,n}}"]);return Q=function(){return e},e}function Z(){var e=Object(v.a)([" Delta node_n^{last} = \frac{partial E}{partial out_n^{last}} \times \frac{partial out_n^{last}}{partial in_n^{last}} = \frac{partial E}{partial in_n^{last}}"],[" \\Delta node_n^{last} = \\frac{\\partial E}{\\partial out_n^{last}} \\times \\frac{\\partial out_n^{last}}{\\partial in_n^{last}} = \\frac{\\partial E}{\\partial in_n^{last}}"]);return Z=function(){return e},e}function $(){var e=Object(v.a)(["= out_k^{last-1}"]);return $=function(){return e},e}function ee(){var e=Object(v.a)(["\frac{partial in_n^{last}}{partial w_{k,n}} = \frac{partial sum_{k=1} out_k^{last-1} \times w_{k,n}}{partial w_{k,n}}"],["\\frac{\\partial in_n^{last}}{\\partial w_{k,n}} = \\frac{\\partial \\sum_{k=1} out_k^{last-1} \\times w_{k,n}}{\\partial w_{k,n}}"]);return ee=function(){return e},e}function te(){var e=Object(v.a)(["\frac{partial out_n^{last}}{partial in_n^{last}} = \frac{partial activation(in_n^{last})}{partial in_n^{last}} = activation'(in_n^{last})"],["\\frac{\\partial out_n^{last}}{\\partial in_n^{last}} = \\frac{\\partial activation(in_n^{last})}{\\partial in_n^{last}} = activation'(in_n^{last})"]);return te=function(){return e},e}function ae(){var e=Object(v.a)(["= actual_n-out_n^{last}"]);return ae=function(){return e},e}function ie(){var e=Object(v.a)(["= 2 \times \frac 1 2 \times (out_n^{last} - actual_n)^{2-1} \times - 1"],["= 2 \\times \\frac 1 2 \\times (out_n^{last} - actual_n)^{2-1} \\times - 1"]);return ie=function(){return e},e}function ne(){var e=Object(v.a)(["\frac{partial E}{partial out_n^{last}} = \frac {partial \frac 1 2 sum_{n=1} (out_n^{last} - actual_n)^2} {partial out_n^{last}}"],["\\frac{\\partial E}{\\partial out_n^{last}} = \\frac {\\partial \\frac 1 2 \\sum_{n=1} (out_n^{last} - actual_n)^2} {\\partial out_n^{last}}"]);return ne=function(){return e},e}function se(){var e=Object(v.a)(["\frac{partial E}{partial w_{k,n}} = \frac{partial E}{partial out_n^{last}} \times \frac{partial out_n^{last}}{partial in_n^{last}} \times \frac{partial in_n^{last}}{partial w_{k,n}}"],["\\frac{\\partial E}{\\partial w_{k,n}} = \\frac{\\partial E}{\\partial out_n^{last}} \\times \\frac{\\partial out_n^{last}}{\\partial in_n^{last}} \\times \\frac{\\partial in_n^{last}}{\\partial w_{k,n}}"]);return se=function(){return e},e}function re(){var e=Object(v.a)(["w_{k,i}^{t+1} =  w_{k,i}^t - alpha \frac{partial E}{partial w_{k,i}}"],["w_{k,i}^{t+1} =  w_{k,i}^t - \\alpha \\frac{\\partial E}{\\partial w_{k,i}}"]);return re=function(){return e},e}function oe(){var e=Object(v.a)(["Error = \frac 1 2 sum_{i=1} (out_i^{last} - actual_i)^2"],["Error = \\frac 1 2 \\sum_{i=1} (out_i^{last} - actual_i)^2"]);return oe=function(){return e},e}function le(){var e=Object(v.a)(["x_j^{t+1} =  x_j^t - alpha \frac{partial f}{partial x_j}"],["x_j^{t+1} =  x_j^t - \\alpha \\frac{\\partial f}{\\partial x_j}"]);return le=function(){return e},e}function he(){var e=Object(v.a)(["x^{t+1} =  x^t - f'(x)"]);return he=function(){return e},e}function ce(){var e=Object(v.a)(["f'(x) = 2x"]);return ce=function(){return e},e}function ue(){var e=Object(v.a)(["f(x) = x^2"]);return ue=function(){return e},e}var de=function(){var e=String.raw(ue()),t=String.raw(ce()),a=String.raw(he()),n=String.raw(le()),s=String.raw(oe()),r=String.raw(re()),o=String.raw(se()),l=String.raw(ne()),h=String.raw(ie()),c=String.raw(ae()),u=String.raw(te()),d=String.raw(ee()),p=String.raw($()),b=String.raw(Z()),j=String.raw(Q()),f=String.raw(Y()),v=String.raw(U()),_=String.raw(J()),g=String.raw(q()),y=String.raw(X()),x=String.raw(K()),m=String.raw(H());return Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Backpropagation "}),Object(i.jsxs)("p",{children:[Object(i.jsx)("b",{children:"Backpropagation"})," is one of the most important things in Neural Networks, it is the method that allows our model to ",Object(i.jsx)("b",{children:"train"}),"and fit to the data we feed. Our goal is to ",Object(i.jsx)("b",{children:"change each weight"})," in the network, so that the predictions of the network match the real outputs. The trick here is to apply an ",Object(i.jsx)("b",{children:"iterative process"})," that will try, step by step, ",Object(i.jsx)("b",{children:"minize the error"})," of the model. Before diving into the process itself we need to understand some things.",Object(i.jsx)("h4",{children:"Gradient descent"}),Object(i.jsx)("b",{children:"Gradient descent"})," is one of the key methods of backpropagation, it is an iterative optimization algorithm, where we try to find the ",Object(i.jsx)("b",{children:"minimum"})," of a function. The principle here is to try to give successive ",Object(i.jsx)("b",{children:"descendent steps"}),", from a starting point, until we can get the minimum point. But how do we do this?",Object(i.jsx)("br",{}),"Lets take this function:",Object(i.jsx)(A,{expressions:e,height:!0}),Object(i.jsx)("img",{src:"/NN_Vizualizer/imgs/x^2.png",alt:"y=x^2",width:"40%",style:{margin:"auto",display:"block"}}),"We can see that our minimum point is at x = 0, which is also the global minimum, the lower point across all function. But how do he get there starting from somewhere? We can imagine a ",Object(i.jsx)("b",{children:"ball rolling down the hill"}),", and we take a step into that direction, so depending on the ",Object(i.jsx)("b",{children:"slope"})," of the fuction we make our move to the next point, and we repeat the process. In this example, for values of x less than 0 we go right, for values of x greater than 0 we go left. This notion of slopes takes us to the ",Object(i.jsx)("b",{children:"derivative"})," of the function:",Object(i.jsx)(A,{expressions:t,height:!0}),Object(i.jsx)("img",{src:"/NN_Vizualizer/imgs/2x.png",alt:"y=2x",width:"40%",style:{margin:"auto",display:"block"}}),"As we can see, the derivative gives us the slope in the ascendent direction, however, if we take a step in the opposite direction we will ",Object(i.jsx)("b",{children:"drive closer"})," to a minimum or an approximation of it. Note that this only works in convex functions.",Object(i.jsx)(A,{expressions:a,height:!0}),"But we are not done yet, sometimes we can take a step in one direction and we when end up further away from the minimum than initialy, so we define a step size, with which we multiply our jump. But how big enough should the step size be? We cannot know exatcly how big it should be but we make a guess, given it is smaller than the optimal one, to avoid moving away from the minimum. This is a defined parameter, known as the ",Object(i.jsx)("b",{children:"learning rate"}),".",Object(i.jsx)("br",{}),"Furthermore, we can apply this principal to each of the dimension of the function, for every variable. If we have a function which takes more then one variable, we can apply this method to each one of the variables. This gives us the following update expression, for each variable in ",Object(i.jsx)("i",{children:"f"}),":",Object(i.jsx)(A,{expressions:n,height:!0}),"For those not familiar with that expression, it means the ",Object(i.jsx)("b",{children:"partial derivative"})," of the function with respect to a variable, in other words, how much the function changes in terms of that specific variable.",Object(i.jsx)("br",{}),"By an iterative approach, repeting this process, we can sucessfully get to a set variable that is more and more close to a local minimum.",Object(i.jsx)("h4",{children:"Backpropagation"}),"Now we are ready to know how ",Object(i.jsx)("b",{children:"Backpropagation"})," works!",Object(i.jsx)("br",{}),"For backpropagation we are going to use ",Object(i.jsx)("b",{children:"gradient descent"}),", but what function are we trying to find the minimum of? Well, we are going to ",Object(i.jsx)("b",{children:"minize the error"})," between the prediction and the actual output. And the set of variables we are updating are the ",Object(i.jsx)("b",{children:"set of weights"})," of our network model, in order to have the lowest error. For convinience we define the error function as follows:",Object(i.jsx)(A,{expressions:s,height:!0}),"This function is convex and allows us to differentiate so that the constants cancel out, that's why it turns out useful to define the error function this way.",Object(i.jsx)("br",{}),"We will consider two cases, the base case being the ",Object(i.jsx)("b",{children:"output layer"}),", and the second case being the ",Object(i.jsx)("b",{children:"remaining layers"}),". As we seen before, we want to update our weights following this expression:",Object(i.jsx)(A,{expressions:r,height:!0}),"But how do we calculate that gradient? We cannot directly calculate that value, but there is a way. As we seen in the previous section, our model can be seen as composite function and  our error function is just being applyed to the results of our model, making it also a composite function as well. So we can the ",Object(i.jsx)("b",{children:"chain rule"}),", which allows us to decompose a derivative into several simpler, computable, derivatives.",Object(i.jsx)("br",{}),Object(i.jsx)("h5",{children:"Output Layer"}),"So, let's start by the ",Object(i.jsx)("b",{children:"first layer"})," (output layer), and then propagate this calculation ",Object(i.jsx)("b",{children:"backwards"}),". For the first layer we can get the follows:",Object(i.jsx)(A,{expressions:o,height:!0}),"We can calculte each of this subexpressions, so we are going to walk through one by one.",Object(i.jsx)("br",{}),"The first part means how much the error changes in terms of the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})}),"  in each node.",Object(i.jsx)(A,{expressions:[l,h,c],height:!0}),"The second part means how much the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})})," changes in terms of the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in value"})}),". We know that the out value is calculated by applying the ",Object(i.jsx)("b",{children:"activation function"}),", so we can use the ",Object(i.jsx)("b",{children:"derivative of the activation function"}),".",Object(i.jsx)(A,{expressions:u,height:!0}),"The third part is how much the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in value"})})," changes in terms of the correspondent ",Object(i.jsx)("b",{children:"weight"}),". We know how the in value is calculated, the first part of the feedfoward, so we can calculate this gradient:",Object(i.jsx)(A,{expressions:[d,p],height:!0}),"One thing we can notice is that for every edge that goes to the same node ",Object(i.jsx)("i",{children:"n"}),", the ",Object(i.jsx)("b",{children:"only"})," thing that changes is the ",Object(i.jsx)("b",{children:"last term"}),", which turns out to depend on the origin node. This value can, then, be saved to be used for updating each weight that goes to node ",Object(i.jsx)("i",{children:"n"}),", we call this the ",Object(i.jsx)("b",{children:"node delta"}),":",Object(i.jsx)(A,{expressions:b,height:!0}),Object(i.jsx)("h5",{children:"Hidden layers"}),"For the ",Object(i.jsx)("b",{children:"hidden layers"}),", we go from the last layer and work our way to the first and apply a similar process. We want to know how much a weight influences the total error, but this time, a weight in the ",Object(i.jsx)("b",{children:"hidden layers"}),", will have influence not only in one output values but ",Object(i.jsx)("b",{children:"every output layer node"}),".",Object(i.jsx)(A,{expressions:j,height:!0}),"The first part here is different here because we must take into account the ",Object(i.jsx)("b",{children:"contribution"})," of the hidden node to every node in the",Object(i.jsx)("b",{children:" next layer"}),". So, we must sum the contributions to the error on the nodes in ht next layer. We get the following expression :",Object(i.jsx)(A,{expressions:f,height:!0}),"As we can see, each term of the sumation sequence will be composed of two parts, the first one, we have calculated before and saved that value, this is the ",Object(i.jsx)("b",{children:"node delta"})," of the ",Object(i.jsx)("b",{children:"next layer"}),", and second expression is how much the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in value"})})," of some node ",Object(i.jsx)("i",{children:"k"}),"changes with respect to the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})})," the previous layer, which can be defined as follows:",Object(i.jsx)(A,{expressions:v,height:!0}),"We can see that this works because the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"in value"})})," of a node only uses the ",Object(i.jsx)("b",{children:Object(i.jsx)("i",{children:"out value"})})," of node ",Object(i.jsx)("i",{children:"n"})," multiplying by the weight of the connection.",Object(i.jsx)("br",{}),"So, putting this all together, our final expression for how much the error changes in terms of the out value of a ",Object(i.jsx)("b",{children:"hidden node "}),"is the follwing:",Object(i.jsx)(A,{expressions:_,height:!0}),"The remaing expressions are deducted the ",Object(i.jsx)("b",{children:"same way"})," as the output layer, so they stay the same, and the node delta can be calculated with this newly expression.",Object(i.jsx)("h5",{children:"Wrapping it all together"}),Object(i.jsx)(A,{expressions:[g,y,x,m],height:!0}),Object(i.jsx)("br",{}),Object(i.jsx)("br",{})]})]})},pe=[{title:"Introduction",component:Object(i.jsx)(C,{})},{title:"Feedforward",component:Object(i.jsx)(G,{})},{title:"Backpropagation",component:Object(i.jsx)(de,{})}],be=a(27),je=a.n(be);var fe=function(e){var t=this;function a(t,a){(0,e.onClick)(t,a)}return Object(i.jsx)("nav",{children:Object(i.jsx)("ul",{className:je.a.Topbar,children:pe.map((function(n,s){var r=je.a.TopbarItem;return e.current===n.title?r+=" "+je.a.isActive:r+=" "+je.a.isNotActive,Object(i.jsx)("li",{className:r,onClick:a.bind(t,n.title,n.component),children:Object(i.jsx)("span",{children:n.title})},s)}))})})},ve=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this)).state={tabName:"Introduction",current:Object(i.jsx)(C,{})},n}return Object(p.a)(a,[{key:"onClick",value:function(e,t){this.setState({tabName:e,current:t})}},{key:"render",value:function(){return Object(i.jsxs)("div",{className:z.a.InfoPanel_wrapper,children:[Object(i.jsx)("div",{children:Object(i.jsx)(fe,{onClick:this.onClick.bind(this),current:this.state.tabName})}),Object(i.jsx)("div",{className:z.a.InfoPanel_content,children:Object(i.jsx)("div",{className:z.a.content_wrapper,children:this.state.current})})]})}}]),a}(s.a.Component),_e=a(10),ge=a.n(_e);var ye=function(e){var t,a=s.a.createRef(),n=Object(i.jsx)("input",{ref:a,type:"text",value:e.value,onChange:function(t){return e.callback(t.target.value)}}),r=ge.a.entry_value+" ";return e.label&&(r+=ge.a.entry_label+" "),e.separator&&(r+=ge.a.entry_separator+" "),e.separator?Object(i.jsx)("div",{className:r}):(e.label&&(t=Object(i.jsx)("button",{onClick:function(){return e.remove()},children:"X"})),Object(i.jsxs)("div",{className:r,children:[n,t]}))};var xe=function(e){var t=ge.a.entry_value+" ";return e.label&&(t+=ge.a.entry_label+" "),e.separator?t+=ge.a.entry_separator+" ":t+=ge.a.entry_button+" ",e.separator?Object(i.jsx)("div",{className:t}):Object(i.jsx)("div",{className:t,children:Object(i.jsx)("button",{onClick:function(){return e.remove()},children:"X"})})},me=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var i;return Object(d.a)(this,a),(i=t.call(this,e)).key=0,i}return Object(p.a)(a,[{key:"setValue",value:function(e,t,a){e[t]=a}},{key:"render",value:function(){var e=this.props.data,t=[],a=0,n=0,s=0;if(this.props.label){t.push(Object(i.jsx)(xe,{separator:!0},"data_aux_separator"+this.key++));for(var r=0;r<this.props.input_labels.length;r++)t.push(Object(i.jsx)(ye,{value:this.props.input_labels[r],remove:this.props.remove.in.bind(this,r),callback:this.props.callback.in.bind(this,r),label:this.props.label},"label_in_value"+a++));t.push(Object(i.jsx)(xe,{separator:!0,label:!0},"data_aux_separator"+this.key++));for(var o=0;o<this.props.output_labels.length;o++)t.push(Object(i.jsx)(ye,{value:this.props.output_labels[o],remove:this.props.remove.out.bind(this,o),callback:this.props.callback.out.bind(this,o),label:this.props.label},"label_out_value"+n++))}else{t.push(Object(i.jsx)(xe,{remove:this.props.removeEntry},"data_aux_separator"+this.key++));for(var l=0;l<e.length;l++)t.push(Object(i.jsx)(ye,{value:e[l],callback:this.props.callback.bind(this,l),label:this.props.label},"data_value"+this.props.index+"->"+s++));t.splice(this.props.in_size+1,0,Object(i.jsx)(ye,{separator:!0},"data_aux_separator"+this.key++))}var h=ge.a.entry;return this.props.active&&(h+=" "+ge.a.active),Object(i.jsx)("div",{className:h,children:t})}}]),a}(s.a.Component),we=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var i;return Object(d.a)(this,a),(i=t.call(this)).key=0,i}return Object(p.a)(a,[{key:"render",value:function(){for(var e=[],t=this.props.changes,a=Object(i.jsx)(me,{input_labels:this.props.input_labels,output_labels:this.props.output_labels,remove:t.remove,callback:t.changeLabels,label:!0}),n=this.props.data,s=this.props.input_labels.length,r=this.props.output_labels.length,o=0;o<n.length;o++)e.push(Object(i.jsx)(me,{in_size:s,out_size:r,data:n[o],index:o,callback:t.changeData.bind(this,o),removeEntry:t.removeDataEntry.bind(this,o),active:o===this.props.currentValue},"grid_entry_"+o));return Object(i.jsxs)("div",{className:ge.a.grid_wrapper,children:[Object(i.jsxs)("div",{className:ge.a.grid_container,children:[a,Object(i.jsx)("div",{style:{overflowY:"auto",flex:"1 0 auto",overflowX:"hidden"},children:Object(i.jsx)("div",{style:{minHeight:"min-content",height:"0"},children:e})})]}),Object(i.jsxs)("div",{className:ge.a.grid_container_buttons,children:[Object(i.jsx)("button",{onClick:t.addInput.bind(this),children:"Add Input"}),Object(i.jsx)("button",{onClick:t.addEntry.bind(this),children:"Add entry"}),Object(i.jsx)("button",{onClick:t.addOutput.bind(this),children:"Add Output"})]})]})}}]),a}(s.a.Component),Oe=a(47),ke=a.n(Oe);var Ne=function(e){var t=e.step?e.step:1,a=function(t){return"log"===e.type&&(t=Math.log(t)),t},s=Object(n.useState)(e.value?a(e.value):a((e.max-e.min)/2)),r=Object(u.a)(s,2),o=r[0],l=r[1],h=Object(n.useState)(e.value?e.value:o),c=Object(u.a)(h,2),d=c[0],p=c[1],b=function(a){var i=1===t?parseInt(a.target.value):parseFloat(a.target.value);l(i),i=function(t){return"log"===e.type&&(t=Math.exp(t)),t}(i),p(1===t?i:i.toFixed(5)),e.callback&&e.callback(i)};return Object(i.jsxs)("div",{className:ke.a.slidecontainer,children:[Object(i.jsx)("input",{type:"range",min:e.min,max:e.max,value:o,step:e.step?e.step:1,class:"slider",onChange:function(e){return b(e)}}),Object(i.jsxs)("span",{id:"rs-bullet",className:ke.a.rs_label,children:[e.info,":",d]})]})},Se=function(e){Object(b.a)(a,e);var t=Object(j.a)(a);function a(e){var i;Object(d.a)(this,a),(i=t.call(this,e)).nn=new m(2,2),i.setNNFromSample("sample1");var n=[],s=[];i.input_key=0,i.output_key=0;for(var r=0;r<i.nn.getInputLayerSize();r++)n.push("Input_"+i.input_key++);for(var o=0;o<i.nn.getOutputLayerSize();o++)s.push("Output_"+i.output_key++);return i.state={neuralNetwork:i.nn,data:[[.05,.1,.01,.99]],input_labels:n,output_labels:s},i.resetDataIndex(),i}return Object(p.a)(a,[{key:"resetDataIndex",value:function(){this.current_index=-1,this.input_index=0}},{key:"setNNFromSample",value:function(e){this.nn.import(w[e])}},{key:"generateNN",value:function(){var e=null;this.state.input_labels.length>0&&(e=this.state.input_labels.length);var t=null;this.state.output_labels.length>0&&(t=this.state.output_labels.length),this.nn.createRandomNN(e,t),this.setNN()}},{key:"randomizeNN",value:function(){this.nn.randomize(),this.setNN()}},{key:"getDataEntry",value:function(){var e=null,t=null;return 0!==this.state.data.length&&(e=this.state.data[this.input_index].slice(0,this.state.input_labels.length),t=this.state.data[this.input_index].slice(-this.state.output_labels.length)),[e,t]}},{key:"incrementEntryIndex",value:function(){this.current_index=this.input_index,this.state.data.length>0&&(this.input_index=(this.input_index+1)%this.state.data.length)}},{key:"feedForward",value:function(){var e=this.getDataEntry(),t=Object(u.a)(e,2),a=t[0],i=t[1];this.incrementEntryIndex(),this.nn.feedforward(a,i),this.setNN()}},{key:"feedForwardStepNode",value:function(){this.current_index=this.input_index;var e=this.getDataEntry(),t=Object(u.a)(e,2),a=t[0],i=t[1];this.nn.feedforwardStepNode(a,i)&&this.incrementEntryIndex(),this.setNN()}},{key:"feedForwardStepLayer",value:function(){this.current_index=this.input_index;var e=this.getDataEntry(),t=Object(u.a)(e,2),a=t[0],i=t[1];this.nn.feedforwardStepLayer(a,i)&&this.incrementEntryIndex(),this.setNN()}},{key:"train",value:function(){var e=this;this.resetDataIndex();var t=[],a=[];this.state.data.forEach((function(i){t.push(i.slice(0,e.state.input_labels.length)),a.push(i.slice(-e.state.output_labels.length))})),this.nn.train(t,a,100),this.setNN()}},{key:"backpropagate",value:function(){this.current_index=this.input_index;var e=this.getDataEntry(),t=Object(u.a)(e,2),a=t[0],i=t[1];null==a&&null==i||(this.nn.backpropagation(a,i),this.incrementEntryIndex(),this.setNN())}},{key:"backpropagateLayer",value:function(){this.current_index=this.input_index;var e=this.getDataEntry(),t=Object(u.a)(e,2),a=t[0],i=t[1];null==a&&null==i||(this.nn.backpropagationLayer(a,i)&&this.incrementEntryIndex(),this.setNN())}},{key:"backpropagateNode",value:function(){this.current_index=this.input_index;var e=this.getDataEntry(),t=Object(u.a)(e,2),a=t[0],i=t[1];null==a&&null==i||(this.nn.backpropagationNode(a,i)&&this.incrementEntryIndex(),this.setNN())}},{key:"addNode",value:function(e){this.nn.addNode(e),this.setNN()}},{key:"addLayer",value:function(e){this.nn.addLayer(e),this.setNN()}},{key:"changeActivationLayer",value:function(e,t){this.nn.setLayerActivation(e,t),this.setNN()}},{key:"setNN",value:function(){this.setState({neuralNetwork:this.nn})}},{key:"addEntry",value:function(){for(var e=this.state.data,t=[],a=0;a<this.state.input_labels.length+this.state.output_labels.length;a++)t.push(0);e.push(t),this.setState({data:e})}},{key:"addInput",value:function(){var e=this,t=this.state.data;t.forEach((function(t){return t.splice(e.state.input_labels.length,0,0)}));var a=this.state.input_labels;a.push("Input_"+this.input_key++),this.nn.addInputNode(),this.setState({neuralNetwork:this.nn,data:t,input_labels:a})}},{key:"addOutput",value:function(){var e=this.state.data;e.forEach((function(e){return e.push(0)}));var t=this.state.output_labels;t.push("Output_"+this.output_key++),this.nn.addOutputNode(),this.setState({neuralNetwork:this.nn,data:e,output_labels:t})}},{key:"removeDataEntry",value:function(e){var t=this.state.data;t.splice(e,1),this.input_index=(this.input_index+this.state.data.length)%+this.state.data.length,e===this.current_index&&(this.current_index=-1),this.setState({data:t})}},{key:"removeInput",value:function(e){var t=this.state.data;t.forEach((function(t){return t.splice(e,1)}));var a=this.state.input_labels;a.splice(e,1),this.nn.deleteInputNode(e),this.setState({neuralNetwork:this.nn,data:t,input_labels:a})}},{key:"removeOutput",value:function(e){var t=this.state.data;t.forEach((function(t){return t.splice(e,1)}));var a=this.state.output_labels;a.splice(e,1),this.nn.deleteOutputNode(e),this.setState({neuralNetwork:this.nn,data:t,output_labels:a})}},{key:"changeInputLabels",value:function(e,t){var a=this.state.input_labels;a[e]=t,this.setState({input_labels:a})}},{key:"changeOutputLabels",value:function(e,t){var a=this.state.output_labels;a[e]=t,this.setState({output_labels:a})}},{key:"changeData",value:function(e,t,a){var i=this.state.data;i[e][t]=a,this.setState({data:i})}},{key:"render",value:function(){var e=this,t={addEntry:this.addEntry.bind(this),addInput:this.addInput.bind(this),addOutput:this.addOutput.bind(this),remove:{in:this.removeInput.bind(this),out:this.removeOutput.bind(this)},changeLabels:{in:this.changeInputLabels.bind(this),out:this.changeOutputLabels.bind(this)},removeDataEntry:this.removeDataEntry.bind(this),changeData:this.changeData.bind(this)},a={addNode:this.addNode.bind(this),addLayer:this.addLayer.bind(this),changeActivation:this.changeActivationLayer.bind(this)};return Object(i.jsxs)("div",{className:z.a.splitScreen,children:[Object(i.jsx)("div",{className:z.a.leftPane,children:Object(i.jsx)(ve,{})}),Object(i.jsx)("div",{className:z.a.rightPane,children:Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:"1 0 auto"},children:[Object(i.jsx)("div",{style:{height:"40%",display:"flex",flexDirection:"column"},children:Object(i.jsx)(we,{data:this.state.data,input_labels:this.state.input_labels,output_labels:this.state.output_labels,changes:t,currentValue:this.current_index})}),Object(i.jsxs)("div",{style:{height:"60%",display:"flex",flexDirection:"column"},children:[Object(i.jsx)(D,{neuralNetwork:this.state.neuralNetwork,num:this.state.num,func:a}),Object(i.jsxs)("div",{className:z.a.buttons_container,style:{flex:"0 0 auto"},children:[Object(i.jsxs)("div",{className:z.a.div_buttons_container,children:[Object(i.jsx)("button",{onClick:this.feedForward.bind(this),children:"FeedForward"}),Object(i.jsx)("button",{onClick:this.feedForwardStepLayer.bind(this),children:"FeedForward Step Layer"}),Object(i.jsx)("button",{onClick:this.feedForwardStepNode.bind(this),children:"FeedForward Step Node"})]}),Object(i.jsxs)("div",{className:z.a.div_buttons_container,children:[Object(i.jsx)("button",{onClick:this.backpropagate.bind(this),children:"Backpropagate"}),Object(i.jsx)("button",{onClick:this.backpropagateLayer.bind(this),children:"Backpropagate Step Layer"}),Object(i.jsx)("button",{onClick:this.backpropagateNode.bind(this),children:"Backpropagate Step Node"})]}),Object(i.jsxs)("div",{className:z.a.div_buttons_container,children:[Object(i.jsx)("button",{onClick:this.randomizeNN.bind(this),children:"Randomize"}),Object(i.jsx)("button",{onClick:this.generateNN.bind(this),children:"Generate"}),Object(i.jsx)("button",{onClick:this.train.bind(this),children:"Train"}),Object(i.jsx)(Ne,{min:1,max:5e3,type:"linear",value:this.state.neuralNetwork.getTrainingTimes(),callback:function(t){return e.state.neuralNetwork.setTrainingTimes(t)},info:"Train iterations"}),Object(i.jsx)(Ne,{min:-10,max:0,step:.01,type:"log",value:this.state.neuralNetwork.getLearningRate(),callback:function(t){return e.state.neuralNetwork.setLearningRate(t)},info:"Learning rate"})]})]}),Object(i.jsx)("div",{style:{flex:"3 0 auto",overflowY:"auto"},children:Object(i.jsx)(A,{expressions:this.state.neuralNetwork.expression})})]})]})})]})}}]),a}(s.a.Component);var Le=function(){return Object(i.jsxs)("div",{className:"App",style:{height:"100vh",display:"flex",flexDirection:"column"},children:[Object(i.jsx)(c,{}),Object(i.jsx)(Se,{})]})},Ee=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,248)).then((function(t){var a=t.getCLS,i=t.getFID,n=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),i(e),n(e),s(e),r(e)}))};o.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(Le,{})}),document.getElementById("root")),Ee()},27:function(e,t,a){e.exports={Topbar:"Topbar_Topbar__XaKPb",TopbarItem:"Topbar_TopbarItem__yNKj6",isNotActive:"Topbar_isNotActive__2rJES",isActive:"Topbar_isActive__i1OG7"}},35:function(e,t,a){e.exports={node_data:"Node_node_data__2MR_S",node:"Node_node__Z0DSe",circle:"Node_circle__10tnP",isActive:"Node_isActive__3eh_8"}},46:function(e,t,a){e.exports={_navbar:"Navbar__navbar__7sUy8","_navbar-logo":"Navbar__navbar-logo__1dElB",_navbar_left:"Navbar__navbar_left__1bpMt","_navbar-right":"Navbar__navbar-right__2CCJT"}},47:function(e,t,a){e.exports={rs_label:"RangeBar_rs_label__2Uggo",slidecontainer:"RangeBar_slidecontainer__2OgoG"}},99:function(e,t,a){}},[[247,1,2]]]);
//# sourceMappingURL=main.d3ec1cf3.chunk.js.map